#!/bin/bash

# Get the absolute path of the directory where this script lives
BASE_DIR=$(dirname "$(readlink -f "$0")")

# Define the path to the tests directory
TEST_DIR="$BASE_DIR/tests/unit"

echo "------------------------------------------------"
echo "üöÄ Running Bash Unit Tests"
echo "------------------------------------------------"

# Check if bats is installed
if ! command -v bats &> /dev/null; then
    echo "‚ùå Error: 'bats' is not installed."
    echo "Install it with: sudo apt install bats"
    exit 1
fi

# Run bats on the unit tests folder
# We use the -p flag to show a pretty summary
bats "$TEST_DIR"

# Capture the exit code of bats
RESULT=$?

echo "------------------------------------------------"
if [ $RESULT -eq 0 ]; then
    echo "‚úÖ All tests passed!"
else
    echo "‚ùå Some tests failed. Check the output above."
fi

exit $RESULT